# ì¼ì¼ í¬ë ˆë”§ ì§€ê¸‰ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ

**êµ¬í˜„ì¼:** 2025ë…„ 10ì›” 29ì¼  
**ê¸°ëŠ¥:** ë§¤ì¼ ìì • 10 í¬ë ˆë”§ ë¬´ë£Œ ì§€ê¸‰

---

## âœ… êµ¬í˜„ ì™„ë£Œ í•­ëª©

### 1. ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½

#### User ëª¨ë¸ì— í•„ë“œ ì¶”ê°€
```python
last_daily_credit_claim = Column(DateTime(timezone=True))  # ë§ˆì§€ë§‰ ì¼ì¼ í¬ë ˆë”§ ì§€ê¸‰ ì‹œê°„
```

**ë§ˆì´ê·¸ë ˆì´ì…˜:**
- `4b08818d25fe_add_last_daily_credit_claim_to_users.py`
- ê¸°ì¡´ ì‚¬ìš©ìëŠ” NULL (ì²« ì§€ê¸‰ ê°€ëŠ¥)

---

### 2. API ì—”ë“œí¬ì¸íŠ¸ (2ê°œ ì¶”ê°€)

#### A. ì¼ì¼ í¬ë ˆë”§ ì§€ê¸‰ ìƒíƒœ í™•ì¸
```
GET /v1/credits/daily-status

Response:
{
  "can_claim": true,
  "next_claim_at": "2025-10-31T00:00:00Z",
  "last_claimed_at": "2025-10-30T01:23:45Z"
}
```

**ê¸°ëŠ¥:**
- ì§€ê¸‰ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
- ë‹¤ìŒ ì§€ê¸‰ ì‹œê°„ ê³„ì‚° (UTC ìì • ê¸°ì¤€)
- ë§ˆì§€ë§‰ ì§€ê¸‰ ì‹œê°„ ë°˜í™˜

---

#### B. ì¼ì¼ í¬ë ˆë”§ ì§€ê¸‰
```
POST /v1/credits/daily-claim

Success Response (200):
{
  "claimed": true,
  "amount": 10,
  "next_claim_at": "2025-10-31T00:00:00Z",
  "new_balance": 1510
}

Error Response (400):
{
  "detail": {
    "message": "Daily credits already claimed",
    "next_claim_at": "2025-10-31T00:00:00Z",
    "hours_remaining": 22
  }
}
```

**ê¸°ëŠ¥:**
- 10 í¬ë ˆë”§ ì§€ê¸‰
- ì¤‘ë³µ ì§€ê¸‰ ë°©ì§€ (í•˜ë£¨ 1íšŒ)
- UTC ìì • ê¸°ì¤€ ë¦¬ì…‹
- íŠ¸ëœì­ì…˜ ìë™ ê¸°ë¡

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê²°ê³¼

### ì „ì²´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ âœ…

```
1ï¸âƒ£ í˜„ì¬ í¬ë ˆë”§ ì”ì•¡ í™•ì¸
  í˜„ì¬ ì”ì•¡: 1500 credits
  ì´ íšë“: 500 credits
  ì´ ì‚¬ìš©: 0 credits

2ï¸âƒ£ ì¼ì¼ í¬ë ˆë”§ ì§€ê¸‰ ìƒíƒœ í™•ì¸
  ì§€ê¸‰ ê°€ëŠ¥: True
  ë§ˆì§€ë§‰ ì§€ê¸‰: None
  ë‹¤ìŒ ì§€ê¸‰: None

3ï¸âƒ£ ì¼ì¼ í¬ë ˆë”§ ì§€ê¸‰ ì‹œë„
  âœ… ì§€ê¸‰ ì„±ê³µ!
  ì§€ê¸‰ ê¸ˆì•¡: 10 credits
  ìƒˆ ì”ì•¡: 1510 credits
  ë‹¤ìŒ ì§€ê¸‰ ì‹œê°„: 2025-10-31T00:00:00Z

4ï¸âƒ£ ì¤‘ë³µ ì§€ê¸‰ ì‹œë„ (ì‹¤íŒ¨ ì˜ˆìƒ)
  âœ… ì¤‘ë³µ ë°©ì§€ ì„±ê³µ!
  ë©”ì‹œì§€: Daily credits already claimed
  ë‚¨ì€ ì‹œê°„: 22ì‹œê°„

5ï¸âƒ£ í¬ë ˆë”§ íˆìŠ¤í† ë¦¬ í™•ì¸
  ì´ ê±°ë˜ ìˆ˜: 2
  ìµœê·¼ ê±°ë˜:
    - bonus: 10 credits (Daily free credits)
    - purchase: 500 credits (Purchased Basic Pack)

6ï¸âƒ£ ìµœì¢… ì”ì•¡ í™•ì¸
  ìµœì¢… ì”ì•¡: 1510 credits
```

---

## ğŸ¯ í•µì‹¬ ê¸°ëŠ¥

### 1. ì¤‘ë³µ ì§€ê¸‰ ë°©ì§€

**ë¡œì§:**
```python
# ë§ˆì§€ë§‰ ì§€ê¸‰ ì‹œê°„ í™•ì¸
last_claim = user.last_daily_credit_claim

# ë‹¤ìŒ ìì • ê³„ì‚° (UTC)
next_midnight = (last_claim + timedelta(days=1)).replace(
    hour=0, minute=0, second=0, microsecond=0
)

# ì•„ì§ ìì •ì´ ì§€ë‚˜ì§€ ì•Šì•˜ìœ¼ë©´ ì—ëŸ¬
if now < next_midnight:
    raise HTTPException(400, "Already claimed")
```

**íŠ¹ì§•:**
- UTC ìì • ê¸°ì¤€
- íƒ€ì„ì¡´ ìë™ ë³€í™˜
- ì •í™•í•œ ì‹œê°„ ê³„ì‚°

---

### 2. íŠ¸ëœì­ì…˜ ìë™ ê¸°ë¡

**ìƒì„±ë˜ëŠ” íŠ¸ëœì­ì…˜:**
```python
CreditTransaction(
    user_id=user.id,
    transaction_type="bonus",
    credits=10,
    balance_after=user.credits,
    description="Daily free credits",
    extra_data={
        "claim_type": "daily",
        "claimed_at": "2025-10-30T01:23:45Z"
    }
)
```

**íˆìŠ¤í† ë¦¬ ì¡°íšŒ:**
- `GET /v1/credits/history` ì—ì„œ í™•ì¸ ê°€ëŠ¥
- `transaction_type=bonus` í•„í„°ë§ ê°€ëŠ¥

---

### 3. ì‚¬ìš©ì ê²½í—˜ ìµœì í™”

#### ì—ëŸ¬ ë©”ì‹œì§€ì— ìœ ìš©í•œ ì •ë³´ í¬í•¨
```json
{
  "message": "Daily credits already claimed",
  "next_claim_at": "2025-10-31T00:00:00Z",
  "hours_remaining": 22
}
```

**í”„ë¡ íŠ¸ì—”ë“œ í™œìš©:**
- ë‚¨ì€ ì‹œê°„ í‘œì‹œ
- ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸
- ë‹¤ìŒ ì§€ê¸‰ ì‹œê°„ ì•ˆë‚´

---

## ğŸ“± í”„ë¡ íŠ¸ì—”ë“œ í†µí•© ê°€ì´ë“œ

### React ì˜ˆì‹œ

```typescript
import { useState, useEffect } from 'react';

function DailyCreditClaim() {
  const [status, setStatus] = useState(null);
  const [claiming, setClaiming] = useState(false);

  // ìƒíƒœ í™•ì¸
  useEffect(() => {
    fetch('/v1/credits/daily-status', {
      headers: { Authorization: `Bearer ${token}` }
    })
      .then(res => res.json())
      .then(setStatus);
  }, []);

  // í¬ë ˆë”§ ì§€ê¸‰
  const claimCredits = async () => {
    setClaiming(true);
    try {
      const res = await fetch('/v1/credits/daily-claim', {
        method: 'POST',
        headers: { Authorization: `Bearer ${token}` }
      });
      
      if (res.ok) {
        const data = await res.json();
        alert(`${data.amount} í¬ë ˆë”§ì„ ë°›ì•˜ìŠµë‹ˆë‹¤!`);
        // ì”ì•¡ ì—…ë°ì´íŠ¸
        updateBalance(data.new_balance);
      } else {
        const error = await res.json();
        alert(`${error.detail.hours_remaining}ì‹œê°„ í›„ì— ë‹¤ì‹œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
      }
    } finally {
      setClaiming(false);
    }
  };

  return (
    <div>
      {status?.can_claim ? (
        <button onClick={claimCredits} disabled={claiming}>
          ì¼ì¼ í¬ë ˆë”§ ë°›ê¸° (10 credits)
        </button>
      ) : (
        <div>
          ë‹¤ìŒ ì§€ê¸‰: {new Date(status?.next_claim_at).toLocaleString()}
        </div>
      )}
    </div>
  );
}
```

---

## ğŸ”„ ìë™ ë¦¬ì…‹ ë¡œì§

### UTC ìì • ê¸°ì¤€

**ì´ìœ :**
- ì „ ì„¸ê³„ ì‚¬ìš©ì ê³µí‰ì„±
- ì„œë²„ ì‹œê°„ëŒ€ ë…ë¦½ì 
- ì¼ê´€ëœ ë¦¬ì…‹ ì‹œê°„

**ê³„ì‚° ë°©ì‹:**
```python
# ë§ˆì§€ë§‰ ì§€ê¸‰: 2025-10-30 01:23:45 UTC
# ë‹¤ìŒ ìì •: 2025-10-31 00:00:00 UTC
# ì§€ê¸‰ ê°€ëŠ¥: 2025-10-31 00:00:00 UTC ì´í›„
```

---

## ğŸ“Š ë¹„ì¦ˆë‹ˆìŠ¤ ì˜í–¥

### 1. ì‚¬ìš©ì ë¦¬í…ì…˜ í–¥ìƒ

**ì¼ì¼ í™œì„± ì‚¬ìš©ì(DAU) ì¦ê°€:**
- ë§¤ì¼ ë¡œê·¸ì¸ ìœ ë„
- í¬ë ˆë”§ ì§€ê¸‰ â†’ AI ê¸°ëŠ¥ ì‚¬ìš© â†’ ì½˜í…ì¸  ìƒì„±
- ìŠµê´€ í˜•ì„± (Daily Habit Loop)

### 2. ë¬´ë£Œ ì‚¬ìš©ì ìœ ì§€

**ê¸°íšì„œ ëª…ì‹œ:**
> ë§¤ì¼ ìì •, ëª¨ë“  ì‚¬ìš©ìì—ê²Œ 10 í¬ë ˆë”§ ë¬´ë£Œ ì§€ê¸‰

**íš¨ê³¼:**
- ë¬´ë£Œ ì‚¬ìš©ìë„ AI ê¸°ëŠ¥ ê²½í—˜ ê°€ëŠ¥
- ìœ ë£Œ ì „í™˜ ê°€ëŠ¥ì„± ì¦ê°€
- ì»¤ë®¤ë‹ˆí‹° í™œì„±í™”

### 3. ìˆ˜ìµí™” ê· í˜•

**í¬ë ˆë”§ ì†Œëª¨:**
- I2V ìƒì„±: 15 í¬ë ˆë”§
- VTV ìŠ¤íƒ€ì¼ ë³€í™˜: 20 í¬ë ˆë”§
- AI ìë™ í†µí•©: 40-50 í¬ë ˆë”§
- AI ìŒì•… ìƒì„±: 5 í¬ë ˆë”§

**ì¼ì¼ 10 í¬ë ˆë”§:**
- 2ì¼ â†’ ìŒì•… ìƒì„± 4íšŒ
- 3ì¼ â†’ I2V ìƒì„± 2íšŒ
- 6ì¼ â†’ VTV ë³€í™˜ 3íšŒ
- 15ì¼ â†’ AI ìë™ í†µí•© 3íšŒ

**ê²°ë¡ :** ë¬´ë£Œ ì‚¬ìš©ìë„ ê¾¸ì¤€íˆ ì‚¬ìš©í•˜ë©´ ê³ ê¸‰ ê¸°ëŠ¥ ê²½í—˜ ê°€ëŠ¥

---

## ğŸ¯ í–¥í›„ ê°œì„  ì‚¬í•­

### 1. ì—°ì† ì¶œì„ ë³´ë„ˆìŠ¤

```python
# 3ì¼ ì—°ì†: +5 í¬ë ˆë”§
# 7ì¼ ì—°ì†: +10 í¬ë ˆë”§
# 30ì¼ ì—°ì†: +50 í¬ë ˆë”§
```

### 2. íƒ€ì„ì¡´ ê¸°ë°˜ ì§€ê¸‰

```python
# ì‚¬ìš©ìì˜ ë¡œì»¬ íƒ€ì„ì¡´ ìì • ê¸°ì¤€
# ë” ë‚˜ì€ ì‚¬ìš©ì ê²½í—˜
```

### 3. í‘¸ì‹œ ì•Œë¦¼

```python
# ì§€ê¸‰ ê°€ëŠ¥ ì‹œ ì•Œë¦¼
# "10 í¬ë ˆë”§ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"
```

---

## ğŸ“ˆ ìµœì¢… í˜„í™©

**ì´ 64ê°œ API ì—”ë“œí¬ì¸íŠ¸** (62ê°œ â†’ 64ê°œë¡œ ì¦ê°€)

### í¬ë ˆë”§ ì‹œìŠ¤í…œ API (6ê°œ)

1. âœ… `GET /v1/credits/packages` - íŒ¨í‚¤ì§€ ì¡°íšŒ
2. âœ… `POST /v1/credits/purchase` - í¬ë ˆë”§ êµ¬ë§¤
3. âœ… `GET /v1/credits/balance` - ì”ì•¡ ì¡°íšŒ
4. âœ… `GET /v1/credits/history` - íˆìŠ¤í† ë¦¬ ì¡°íšŒ
5. âœ… `GET /v1/credits/daily-status` - ì¼ì¼ ì§€ê¸‰ ìƒíƒœ **(NEW)**
6. âœ… `POST /v1/credits/daily-claim` - ì¼ì¼ í¬ë ˆë”§ ì§€ê¸‰ **(NEW)**

---

## âœ… ê¸°íšì„œ ìš”êµ¬ì‚¬í•­ ì¶©ì¡±

**ê¸°íšì„œ ëª…ì‹œ:**
> **ë¬´ë£Œ ì œê³µ**: ë§¤ì¼ ìì •, ëª¨ë“  ì‚¬ìš©ìì—ê²Œ 10 í¬ë ˆë”§ ë¬´ë£Œ ì§€ê¸‰

**êµ¬í˜„ ìƒíƒœ:** âœ… ì™„ë£Œ

**íŠ¹ì§•:**
- âœ… ë§¤ì¼ 10 í¬ë ˆë”§ ì§€ê¸‰
- âœ… UTC ìì • ê¸°ì¤€ ë¦¬ì…‹
- âœ… ì¤‘ë³µ ì§€ê¸‰ ë°©ì§€
- âœ… íŠ¸ëœì­ì…˜ ìë™ ê¸°ë¡
- âœ… ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€
- âœ… í”„ë¡ íŠ¸ì—”ë“œ í†µí•© ìš©ì´

---

**êµ¬í˜„ì:** Manus AI  
**êµ¬í˜„ ì™„ë£Œì¼:** 2025ë…„ 10ì›” 29ì¼

